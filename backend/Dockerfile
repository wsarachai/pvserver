FROM node:10.24.0

ARG DEFAULT_NODE_ENV=development
ARG DEFAULT_PORT=3000
ARG DEFAULT_LOG_LEVEL=verbose
ARG DEFAULT_LOG_FILE=/tmp/logs/pvserver.log
ARG DEFAULT_MOCK_UP_DATA=false
ARG DEFAULT_PVSYSTEM_ROOT=./public
ARG DEFAULT_DB_HOST=mysql
ARG DEFAULT_DB_USER=root
ARG DEFAULT_DB_PASSWORD=1234
ARG DEFAULT_DB_DATABASENAME=pvdb
ARG DEFAULT_CO2AVOIDED_VALUE=0.440
ARG DEFAULT_PV_SYSTEM_POWER_YOTSUK=302080
ARG DEFAULT_PV_SYSTEM_POWER_REW_A=100800
ARG DEFAULT_PV_SYSTEM_POWER_REW_B=208600
ARG DEFAULT_PV_LOCATION_YOTSUK=https://goo.gl/maps/gWCkN2AaDC65GSqdA
ARG DEFAULT_PV_LOCATION_REW=https://goo.gl/maps/sPoSabDpenE56SrP6
ARG DEFAULT_COMMISSIONING_YOTSUK=6/21/2020
ARG DEFAULT_COMMISSIONING_REW=9/1/2020

WORKDIR /app

COPY package.json .

RUN npm install

COPY . .

ENV NODE_ENV ${DEFAULT_NODE_ENV}
ENV PORT ${DEFAULT_PORT}
ENV LOG_LEVEL ${DEFAULT_LOG_LEVEL}
ENV LOG_FILE ${DEFAULT_LOG_FILE}
ENV MOCK_UP_DATA ${DEFAULT_MOCK_UP_DATA}
ENV PVSYSTEM_ROOT ${DEFAULT_PVSYSTEM_ROOT}
ENV DB_HOST ${DEFAULT_DB_HOST}
ENV DB_USER ${DEFAULT_DB_USER}
ENV DB_PASSWORD ${DEFAULT_DB_PASSWORD}
ENV DB_DATABASENAME ${DEFAULT_DB_DATABASENAME}
ENV CO2AVOIDED_VALUE ${DEFAULT_CO2AVOIDED_VALUE}
ENV PV_SYSTEM_POWER_YOTSUK ${DEFAULT_PV_SYSTEM_POWER_YOTSUK}
ENV PV_SYSTEM_POWER_REW_A ${DEFAULT_PV_SYSTEM_POWER_REW_A}
ENV PV_SYSTEM_POWER_REW_B ${DEFAULT_PV_SYSTEM_POWER_REW_B}
ENV PV_LOCATION_YOTSUK ${DEFAULT_PV_LOCATION_YOTSUK}
ENV PV_LOCATION_REW ${DEFAULT_PV_LOCATION_REW}
ENV COMMISSIONING_YOTSUK ${DEFAULT_COMMISSIONING_YOTSUK}
ENV COMMISSIONING_REW ${DEFAULT_COMMISSIONING_REW}

EXPOSE ${PORT}

CMD ["npm", "start"]

